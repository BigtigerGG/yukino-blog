---
title: 动画和过渡
date: 2020/1/20 23:31:25
tags:
- Vue Motion
categories:
- Vue
- Vue Base
---
# 动画和过度

这篇文章记录了 Vue 对动画和过度效果的支持，同时记录了我的一些理解

## **组件的过渡**
Vue 提供了 `transition` 内置组件用于下列情形的任意元素的过渡：
- 条件渲染（`v-if`)
- 条件展示（`v-show`)
- 动态组件（被 `component` 包裹的组件）
- 组件根节点

被 `transition` 组件包裹的组件在插入或者删除的时候，Vue 会做下述护理：  

1. 自动探测 `transition` 组件是否应用了 css过渡或者动画，如果是，则在恰当的时机  
   添加或者删除相应的 class 类

2. 如果过渡组件提供了相应的 Javascript 钩子函数，这些钩子函数会在恰当的时机被调用  

3. 如果没有上述两种情况，则 DOM 操作会在下一帧立即执行，也就是说没有过渡的效果

使用 `transition` 组件的方法是给这个组件定义一个 name 属性，这个属性会作为下面六种 Vue  
内置的 CSS 过渡类的类名前缀，在样式表中探测是否存在这种格式的类，并在适当的时机为包裹  
元素添加相应的类名。这六种过渡类分别是：  

1. `v-enter` : 定义了**进入**过渡的开始状态，也就是这个组件被插入之前的 class 类，这个class  
   在元素被插入之后的下一帧移除。  
2. `v-enter-active` ：定义了**进入**过渡生效时的状态，这个 class 类在整个过渡过程的时候生  
   效，在过渡 / 动画完成后移除。这个类通常被用来设置过渡的效果，例如过渡时间，过渡  
   曲线等，动画类似。
3. `v-enter-to` : 定义了**进入**过渡的结束状态。在元素被插入的下一帧生效，在过渡 / 动画完成  
   时候移除。
4. `v-leave` : 定义了**离开**过渡的开始状态，对应 `v-enter-to` 的状态，在离开过渡触发生效，  
   下一帧被移除。
5. `v-leave-active` ：定义了**离开**过渡的生效状态，同 `v-enter-active`。
6. `v-leave-to` : 定义了**离开**过渡的结束状态，同 `v-enter`。
   
下图展示了这六种 class 类的在整个过渡过程的生效时间：  

![transition](/yukino-blog/images/transition.png)

需要注意的是，  
1. 这里的 v 前缀是当 `transition` 组件没有定义 `name` 属性的时候默认的。  
当定义了 `name` 属性的时候，这个 v 会被替换为 `name` 所定义的内容。
2. css 动画的使用和过渡类似，唯一的区别是 `v-enter` 类名再节点被插入  
时候不会被立即删除，而是在 `animationend` 事件触发的时候被删除。

### **自定义过渡的类名**

当想要使用第三方 css 类库的时候，我们可以定义 `transition` 组件的内联样式属性：  

- `enter-class`
- `enter-active-class`
- `enter-to-class`
- `leave-class`
- `leave-active-class`
- `leave-to-class`

这六个作为 `transition` 组件的属性具有最高优先级，可以和 Vue 的过渡系统结合起来。

### **同时使用过渡和动画**

当想要给过渡或者动画添加事件监听机制的时候，需要给 `transition` 组件添加相应的事  
件监听器，过渡—— `transitionend`, 动画—— `animationend`。Vue 会根据具体的 CSS  
识别并添加监听器。  

当同时使用这两种效果的时候。 需要在 `transition` 组件明确指定 `type` 这个属性并设置  
`transition` 或者 `animation` 来区分这两种动效。

### **多个元素（组件）的过渡**
当一个 `transition` 组件包含多个元素（组件）的时候，且这些元素（组件）在同一时间  
只渲染一个的时候，可以在 `transition` 组件中使用 `v-if`, `v-else`, 控制元素的渲染，用  
动态组件控制组件的渲染。  

需要注意的是这些元素（组件）的切换的时候，它们的渲染模式在默认情况下是进入状态  
和离开状态同时发生。这在某些情况下可能达不到预期的效果， Vue 提供了过渡模式，让  
两个组件的渲染过渡拥有先后次序：  

- `in-out` : 新元素先进行过渡，过渡完成后当前元素过渡离开
- `out-in` : 当前元素先进行过渡，过渡完成后新元素过渡进入  

